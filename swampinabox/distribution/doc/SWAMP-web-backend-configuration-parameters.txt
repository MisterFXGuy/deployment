SWAMP Web Application Server Configuration
==========================================

The ".env" file
---------------
At the top level of the web server directory, you will find a file
called ".env".  This file contains the various parameter names and
values that are used to configure the SWAMP web application. You must
have root access to modify this file.

For SWAMP-in-a-Box, this file is located at:
/var/www/swamp-web-server/.env

This file contains the following parameters:

Web Application settings
------------------------
These are miscellaneous parameters related to the SWAMP web application.

    APP_ENV
    : a description of the SWAMP environment.
    This is informational. When installing SWAMP-in-a-Box, APP_ENV is
    set to "SWAMP-in-a-Box".

    APP_DEBUG
    : whether verbose Laravel debugging is on or off.
    Set to "true" or "false". When set to "true", web server errors
    return a detailed error page through the Laravel framework. When
    set to "false", such errors return a page that says "whoops, looks
    like something went wrong." APP_DEBUG is set to "false" for
    SWAMP-in-a-Box.

    APP_URL
    : the URL used to access SWAMP web routes.
    APP_URL is determined when SWAMP-in-a-Box is installed
    based on the hostname of the SWAMP-in-a-Box machine.

    APP_CORS_URL
    : the URL used to access the SWAMP web site.
    APP_CORS_URL is determined when SWAMP-in-a-Box is
    installed based on the hostname of SWAMP-in-a-Box machine.

    Note: For SWAMP-in-a-Box installations the APP_URL and the
    APP_CORS_URL are the same.

    APP_FLOODLIGHT
    : URL and port for the Floodlight server.
    This is not applicable for a SWAMP-in-the-Box installation.

    APP_INCOMING
    : the path to the directory used to temporarily store files uploaded
    for new packages.
    This should always be set to "/swamp/incoming/".

    APP_KEY
    : a random encryption key used by the Laravel framework.
    This can be any 16 or 32 character string. APP_KEY is set to a
    random 32 character string when SWAMP-in-a-Box is installed and
    should not need to be changed afterwards.
    
    APP_PASSWORD_ENCRYPTION_METHOD
    : the encryption method used by the SWAMP backend to hash user passwords
    before either storing them in the SWAMP database or sending them to an 
    LDAP server if LDAP is enabled.
    Set APP_PASSWORD_ENCRYPTION_METHOD to "BCRYPT", "SSHA", "SHA1", or "NONE".
    APP_PASSWORD_ENCRYPTION_METHOD is set to "BCRYPT" when SWAMP-in-a-Box is
    installed.
    This should only be set to "NONE" if LDAP_ENABLED is "true", LDAP_READ_ONLY is
    "false", and the LDAP server does its own encryption when given a new or changed
    user password, in which case passwords would be encrypted twice if 
    APP_PASSWORD_ENCRYPTION_METHOD were set to anything other than "NONE".
    This setting is not applicable when LDAP_ENABLED is "true" and LDAP_READ_ONLY
    is "true".
    
	APP_PASSWORD_MAX
	: the maximum number of Application Passwords a user can create.
	Set this to an integer greater than zero to allow creation of one or more 
	Application passwords. Set this to zero to disallow creation of Application
	Passwords.
	APP_PASSWORD_MAX is set to "10" when SWAMP-in-a-Box is installed.
    

HT Condor settings
------------------
These parameters provide the SWAMP web application access to the HT Condor
collector.

    HTCONDOR_COLLECTOR_HOST
    : the host name of the HT Condor Collector.
    HTCONDOR_COLLECTOR is determined when SWAMP-in-a-Box is
    installed based on the hostname of the SWAMP-in-a-Box machine.

Mail settings
-------------
These parameters are related to outgoing email sent by the SWAMP web
application. By default, SWAMP-in-a-Box is installed with outgoing mail
disabled.

    MAIL_ENABLED
    Whether the SWAMP web application is configured for outgoing mail
    Set to "true" or "false". When set to "false", outgoing mail is
    disabled and the subsequent mail-related settings are not used.
    When outgoing email is disabled, all functionality that would
    otherwise result in an email being sent by the system runs without
    sending the email. Specifically:
    - username is displayed instead of email throughout the user
      interface.
    - Workflows that rely on email (such as requesting a password reset)
      are disabled.
    - Permission requests, project invitations, and SWAMP admin
      invitations are handled exclusively through the notification
      system.
    - New user accounts do not go through a "pending" state and are
      immediately activated (without need of verification).
    - The option to receive an email on completion of an assessment
      is removed.
    - The Administrator Settings page for Restricted Domains is removed.
    - The Administrator Settings page for System Emails is removed
    - Contact Us and Report Security Incident pages (if enabled) do not
      include a means to submit a message directly through the web
      interface.
    MAIL_ENABLED is set to "false" when SWAMP-in-a-Box is installed.

    Note: Prior to setting MAIL_ENABLED to "true" and configuring the
    other corresponding mail settings in the .env file, you must first
    configure an outgoing email server for the SWAMP-in-a-Box machine.

    MAIL_DRIVER
    : the driver used to send outgoing email.
    Set to "smtp" or "sendmail". The "sendmail" driver uses the system's
    postfix mail system to do the actual delivery of the email message.
    The "smtp" driver bypasses postfix and makes connections directly to
    your SMTP server to try and deliver the message. With the "smtp"
    driver, the UI will wait for an acknowledgment that the message was
    sent. Whereas, if there are issues sending, the "sendmail" driver via
    postfix will attempt to retry delivering of the message in the
    background without causing the UI to wait. Therefore we recommend
    using the "sendmail" driver.

    MAIL_HOST
    : the hostname of the SMTP server.
    This is applicable only if the MAIL_DRIVER is set to "smtp".

    MAIL_PORT
    : the SMTP port of the SMTP server.
    This is only applicable if the MAIL_DRIVER is set to "smtp".

    MAIL_FROM_ADDRESS
    : the email address to be used as the sender for outgoing SWAMP email.

    MAIL_FROM_NAME
    : the name to be used as the sender of outgoing SWAMP email.

    MAIL_CONTACT_ADDRESS
    : the email address to which messages submitted via the Contact Us
    page are sent.
    Use this to direct contact messages to a specific administrator or
    help desk. This address is also displayed in the content of some
    SWAMP emails.

    MAIL_CONTACT_NAME
    : the name to which messages submitted via the Contact Us page are
    sent.

    MAIL_SECURITY_ADDRESS
    : the email address to which messages submitted via the Report
    Security Incident page are sent.
    Use this to direct security messages to a specific administrator or
    help desk. This address is also displayed in the content of some
    SWAMP emails.

    MAIL_SECURITY_NAME
    : the name to which messages submitted via the Report Security
    Incident page are sent.

    MAIL_ENCRYPTION
    : if the MAIL_DRIVER is set to "smtp" and the SMTP server uses
    encryption, the type of encryption used.
    This is only applicable if the MAIL_DRIVER is set to "smtp" and the
    specified SMTP server uses encryption. Otherwise, set this to "null".

    MAIL_USERNAME
    : if the MAIL_DRIVER is set to "smtp" and the SMTP server requires a
    username/password, the username.
    This is only applicable if the MAIL_DRIVER is set to "smtp" and the
    specified SMTP server requires a username/password. Otherwise, set
    this to "null".

    MAIL_PASSWORD
    : if the MAIL_DRIVER is set to "smtp" and the SMTP server requires a
    username/password, the password.
    This is only applicable if the MAIL_DRIVER is set to "smtp" and the
    specified SMTP server requires a username/password. Otherwise, set
    this to "null".

LDAP settings
-------------
These parameters are related to configuring an LDAP server to store
user-related personal information for a SWAMP instance. When SWAMP is
not configured to use an LDAP server, user-related personal information
is stored in the mysql database.
When installed, a SWAMP-in-the-Box system is not configured to use an
LDAP server.

    LDAP_ENABLED
    : whether the SWAMP uses an LDAP/AD server for user authentication and storing of 
    user data.
    Set to "true" or "false". When set to "false", a record is created
    for each SWAMP user in the project database. When set to "true", a
    record is created for each SWAMP user in the LDAP/AD server.
    LDAP_ENABLED is set to "false" when SWAMP-in-a-Box is installed.

	LDAP_PASSWORD_VALIDATION
	:  Whether verification of a user password on sign-in is done by LDAP.
	Set to "true" or "false". When set to "true" user passwords are authenticated
	through an LDAP bind. When set to "false" passwords are authenticated in PHP 
	by comparing them to the hash stored in LDAP.
	Set this to "true" when LDAP is enabled and your LDAP server is able to 
	validate against the type of encryption used to store passwords. Set this to
	"false" when LDAP is enabled and LDAP is not able to validate against the type
	of encryption used to store passwords, such as when LDAP_READ_ONLY is "false" 
	and APP_PASSWORD_ENCRYPTION_METHOD is "BCRYPT".
	LDAP_PASSWORD_VALIDATION is set to "false" when SWAMP-in-a-Box is installed.
	
	LDAP_READ_ONLY
	: Whether SWAMP is prevented from adding or editing user records in the LDAP
	server. 
	Set to "true" or "false". When set to "false", the SWAMP codebase assumes SWAMP has
	total control over user attributes and LDAP entries. In this case SWAMP should be the
	only client of the LDAP server. When set to "true", the SWAMP codebase assumes that
	creation and editing of user attributes and LDAP entries is to be done outside of the 
	SWAMP. As such, the SWAMP user interface disables any workflows that would result in 
	the creation or editing of user records, including user passwords. Specifically:
	- The sign up button is removed from the SWAMP home page.
	- Any user with a record in the LDAP server can sign in to the SWAMP. Supporting 
	  records in the SWAMP database are created automatically on sign in.
	- The "Reset my password" link is removed from the sign-in page.
	- The Linked Account Use Policy page (if a 3rd party account linking is enabled) does
	  not allow creation of new accounts, only linking to existing accounts.
	- The user profile page displays user demographics as stored in LDAP, but does not 
	  allow them to be edited in the SWAMP UI.
	- The user profile page does not include options to change or reset passwords.
	- The user profile page does not include the option to delete a user account.
	- The SWAMP administrator Review Accounts page does not provide options to flag
	  accounts as hibernated or to require a password reset. Nor does it allow SWAMP
	  administrators to change a user's status, edit user demographics, or reset 
	  passwords.
	This should be set to "true" if you are using a preexisting LDAP/AD server. 
	LDAP_READ_ONLY is set to "false" when SWAMP-in-a-Box is installed.
	
	LDAP_MIR_SWAMP
	: Whether the LDAP server is configured with the schema used in the mir-swamp.org
	LDAP server. 
	Set to "true" or "false".
	The purpose of this parameter is to support setting a legacy, required attribute 
	in the LDAP server used by mir-swamp.org. In all other cases this should be set to 
	false.
	LDAP_MIR_SWAMP is set to "false" when SWAMP-in-a-Box is installed.

    LDAP_HOST
    : the URI of the LDAP/AD server.
    When LDAP_ENABLED=true, this option MUST be set to the
	protocol+host for the LDAP/AD server, e.g., ldaps://ldap.example.org .
	The specified LDAP server must support LDAP protocol 3
    This is only applicable if LDAP_ENABLED is set to "true".

    LDAP_PORT
    : the port of the configured LDAP_HOST.
    LDAP_PORT is set to 636 when SWAMP-in-a-Box is installed.
    This is only applicable if LDAP_ENABLED is set to "true".

	LDAP_BASE_DN
	: the RDN search base for LDAP searches.
	This will need to be set based on the configuration of base DN of the LDAP directory 
	for your users.
    LDAP_BASE_DN is set to 'ow=people,o=SWAMP,dc=cosalab,dc=org' when SWAMP-in-a-Box is 
    installed.
    This is only applicable if LDAP_ENABLED is set to "true".
	
	LDAP_USER_RDN_ATTR
	: the Prefix RDN attribute for users in the LDAP/AD server.
	This will need to be set based on how 'dn' fields are formed in the LDAP/AD server 
	used.
	LDAP_USER_RDN_ATTR is set to 'swampUuid' when SWAMP-in-a-Box is installed.
	This is only applicable if LDAP_ENABLED is set to "true".
	
	LDAP_SWAMP_UID_ATTR
	: the LDAP attribute to be used as an index into the SWAMP database.
	This must be set to an attribute that uniquely identifies each user and is 
	unchangeable. Often this will be the same as the LDAP_USER_RDN_ATTR.
	LDAP_SWAMP_UID_ATTR is set to 'swampUuid' when SWAMP-in-a-Box is installed.
	Note that this attribute will be used to identify users in the Web API, and, as such
	will be displayed in URLs for SWAMP web pages with data for a specific user.
	This is only applicable if LDAP_ENABLED is set to "true".
	
	LDAP_FIRSTNAME_ATTR
	: the LDAP attribute for user first name.
	LDAP_FIRSTNAME_ATTR is set to 'givenName' when SWAMP-in-a-Box is installed.
	If your LDAP/AD server uses a different field for storing users' first names, 
	enter it here.
	This is only applicable if LDAP_ENABLED is set to "true".
	If LDAP_READ_ONLY is set to "false", this attribute can be edited through the SWAMP
	web interface.
	If LDAP_READ_ONLY is set to "true" and your LDAP/AD server does not have an attribute 
	used for user first name, set LDAP_FIRSTNAME_ATTR to 'ignore'.
	
	LDAP_LASTNAME_ATTR
	: the LDAP attribute for user last name.
	LDAP_LASTNAME_ATTR is set to 'sn' (surname) when SWAMP-in-a-Box is installed.
	If your LDAP/AD server uses a different field for storing users' last names, 
	enter it here.
	This is only applicable if LDAP_ENABLED is set to "true".
	If LDAP_READ_ONLY is set to "false", this attribute can be edited through the SWAMP
	web interface.
	If LDAP_READ_ONLY is set to "true" and your LDAP/AD server does not have an attribute 
	used for user last name, set LDAP_LASTNAME_ATTR to 'ignore'.
	
	LDAP_FULLNAME_ATTR
	: the LDAP attribute for user full name.
	LDAP_FULLNAME_ATTR is set to 'cn' (common name) when SWAMP-in-a-Box is installed.
	If your LDAP/AD server uses a different field for storing users' full names, 
	enter it here. 
	This is only applicable if LDAP_ENABLED is set to "true".
	If LDAP_READ_ONLY is set to "false", SWAMP will generally set this attribute to either
	the first and last name of a given user, or to 'none'. It is not directly editable in 
	the SWAMP web interface.
	If your LDAP/AD server does not have an attribute used for full names, 
	set LDAP_FULLNAME_ATTR to 'ignore' and SWAMP will not set it.
	
	LDAP_PASSWORD_ATTR
	: the LDAP attribute for user passwords.
	LDAP_PASSWORD_ATTR is set to 'userPassword' when SWAMP-in-a-Box is installed.
	If your LDAP/AD server uses a different field for storing users' passwords, enter it
	here.
	This is only applicable if LDAP_ENABLED is set to "true".
	If LDAP_READ_ONLY is set to "false", a user will be able to set a password on signing 
	up for the SWAMP and later be able to change it through the SWAMP web interface.

	LDAP_USERNAME_ATTR
	: the LDAP attribute to be mapped to the SWAMP username.
	LDAP_USERNAME_ATTR is set to 'uid' when SWAMP-in-a-Box is installed. If your LDAP/AD 
	server uses a different field for usernames, enter it here. This must be set to an 
	attribute that uniquely identifies each user.
	This is only applicable if LDAP_ENABLED is set to "true".
	If LDAP_READ_ONLY is set to "false", this attribute can be edited through the SWAMP
	web interface as long as the new value is unique.
	
	LDAP_EMAIL_ATTR
	: the LDAP attributed for user email addresses.
	LDAP_EMAIL_ATTR is set to 'mail' when SWAMP-in-a-Box is installed.
	If your LDAP/AD server uses a different field for storing users' email addresses, 
	enter it here.
	This is only applicable if LDAP_ENABLED is set to "true".
	If EMAIL_ENABLED is set to "true" and LDAP_READ_ONLY is set to "false", this attribute 
	can be edited through the SWAMP web interface.
	If LDAP_READ_ONLY is set to "false" and EMAIL_ENABLED is also set to "false", you can
	set LDAP_EMAIL_ATTR to 'ignore' and SWAMP will not set it. Otherwise, in this case,
	SWAMP will set  the email attribute in LDAP to a space (" "). 
	
	LDAP_ORG_ATTR
	: the LDAP attribute for user affiliation.
	LDAP_ORG_ATTR is set to 'o' (organization) when SWAMP-in-a-Box is installed.
	If your LDAP/AD server uses a different field for storing users' affiliations, 
	enter it here. This should be an optional attribute in LDAP.
	This is only applicable if LDAP_ENABLED is set to "true".
	If LDAP_READ_ONLY is set to "false", this attribute can be edited through the SWAMP
	web interface.
	If LDAP_READ_ONLY is set to "true" and your LDAP/AD server does not have an attribute 
	used for user affiliation, set LDAP_ORG_ATTR to 'ignore'.
	
	LDAP_OBJECTCLASS
	: a comma-separated list of objectClass attributes to be set for each user.
	LDAP_OBJECTCLASS is set to 
	'top,person,organizationalPerson,inetOrgPerson,eduPerson,swampEntity' when
	SWAMP-in-a-Box is installed, which defines the following objectClass attributes:
		- objectClass: top
		- objectClass: person
		- objectClass: organizationalPerson
		- objectClass: inetOrgPerson
		- objectClass: eduPerson
		- objectClass: swampEntity
	Set this to a comma-separated list of the objectClass attributes required by your
	LDAP server.
	This is only applicable if LDAP_ENABLED is set to "true" and LDAP_READ_ONLY is set to 
	"false".

    LDAP_WEB_USER
    : the full 'dn' of a credentialed LDAP user with global LDAP read access.
    The SWAMP web server uses this to get information about SWAMP users from LDAP.
    This is only applicable if LDAP_ENABLED is set to "true".

    LDAP_WEB_USER_PASSWORD
    : the password for the LDAP_WEB_USER.
    This is only applicable if LDAP_ENABLED is set to "true".

    LDAP_PASSWORD_SET_USER
    : the full 'dn' of a credentialed LDAP user with permission to change other users' 
    passwords
    The SWAMP web server uses this to create and change user passwords in LDAP.
    This is only applicable if LDAP_ENABLED is set to "true" and LDAP_READ_ONLY is set to 
	"false". 

    LDAP_PASSWORD_SET_USER_PASSWORD
    : the password for the LDAP_SET_USER.
    This is only applicable if LDAP_ENABLED is set to "true" and LDAP_READ_ONLY is set to 
	"false".

Third-Party login settings
--------------------------
SWAMP can be configured to allow users to sign in with using credentials
from third party sites. This requires setting up an OAuth Application
for each third party site. Supported third party sites are GitHub, Google, and
CILogon. When installed, a SWAMP-in-the-Box system is not configured to
allow any third party logins.

    GITHUB_ENABLED
    : whether the SWAMP web application allows sign-in via GitHub
    Set to "true" or "false". When set to "true", SWAMP provides a means
    to sign up and sign in via a GitHub account. GITHUB_ENABLED is
    set to "false" when SWAMP-in-a-Box is installed.

    GITHUB_CLIENT_ID
    : the Client ID set in the GitHub OAuth Application.
    This is only applicable when GITHUB_ENABLED is set to "true".

    GITHUB_CLIENT_SECRET
    : the Client Secret set in the GitHub OAuth Application.
    This is only applicable when GITHUB_ENABLED is set to "true".

    GOOGLE_ENABLED
    : whether the SWAMP web application allows sign-in via Google
    Set to "true" or "false". When set to "true", SWAMP provides a means
    to sign up and sign in via a Google account. GOOGLE_ENABLED is
    set to "false" when SWAMP-in-a-Box is installed.

    GOOGLE_CLIENT_ID
    : the Client ID set in the Google OAuth Application.
    This is only applicable when GOOGLE_ENABLED is set to "true".

    GOOGLE_CLIENT_SECRET
    : the Client Secret set in the GOOGLE OAuth Application.
    This is only applicable when GOOGLE_ENABLED is set to "true".

    CILOGON_ENABLED
    : whether the SWAMP web application allows sign-in via CILogon
    Set to "true" or "false". When set to "true", SWAMP provides a means
    to sign up and sign in via a CILogon account. CILOGON_ENABLED is
    set to "false" when SWAMP-in-a-Box is installed.

    CILOGON_CLIENT_ID
    : the Client ID set in the CILogon OAuth Application.
    This is only applicable when CILOGON_ENABLED is set to "true".

    CILOGON_CLIENT_SECRET
    : the Client Secret set in the CILogon OAuth Application.
    This is only applicable when CILOGON_ENABLED is set to "true".

API settings
------------
These parameters provide access to an experimental interface for documenting
the SWAMP web API. This interface requires additional database tables that are
not part of the SWAMP-in-a-Box install.

    API_EXPLORER_ENABLED
    : whether the API Explorer interface is made available.
    API_EXPLORER_ENABLED should always be set to "false" for a
    SWAMP-in-a-Box installation

Session related settings
------------------------
These parameters define how session (logon) cookies behave.

    SESSION_DRIVER
    : the driver used to manage user session data.
    This is set to "cookie" when SWAMP-in-a-Box is installed. This
    should not be changed.

    SESSION_LIFETIME
    : determines the expiration date for SWAMP session cookies, in
    minutes, from the time they are issued.
    This is set to "2160" (36 hours) when SWAMP-in-a-Box is installed.
    Set it to "0" if you are setting SESSION_EXPIRE_ON_CLOSE to "true".

    SESSION_EXPIRE_ON_CLOSE
    : whether SWAMP session cookies expire when the session ends.
    SESSION_EXPIRE_ON_CLOSE is set to "false" when SWAMP-in-a-Box is
    installed. SESSION_LIFETIME should be set to "0" before changing
    this to "true".

    SESSION_COOKIE_NAME
    : the name of the SWAMP session cookie.
    This is set to "swamp_session" when SWAMP-in-a-Box is installed.

    SESSION_COOKIE_DOMAIN
    : the name of the domain for the session cookie.
    Set to "null" to use the same domain name as the APP_URL.
    SESSION_COOKIE_DOMAIN is set to "null" when SWAMP-in-a-Box is
    installed.

    SESSION_COOKIE_SECURE
    : whether SWAMP session cookies are sent for encrypted connections
    only.
    SESSION_COOKIE_SECURE is set to "true" when SWAMP-in-a-Box is
    installed.

Database settings
-----------------
These parameters provide the SWAMP web application with access to SWAMP
databases. There is a set of parameters for each of the following
databases:

  - Project
  - Package
  - Tool
  - Platform
  - Assessment
  - Viewer

    [DB]_HOST
    : the hostname for the mysql database.
    This is set automatically when SWAMP-in-a-Box is installed and
    should not need to be changed.

    [DB]_PORT
    : the port used to access the mysql database.
    The default is port 3306. This is set automatically when
    SWAMP-in-a-Box is installed and should not need to be changed.

    [DB]_DATABASE
    : the name of each database (project, package, tool, platform,
    assessment, or viewer) for which the set of parameters applies.
    This is set automatically when SWAMP-in-a-Box is installed and
    should not need to be changed.

    [DB]_USERNAME
    : the mysql user whose credentials will be used by the SWAMP web
    application to access the database.
    The default is "web". This is set automatically when SWAMP-in-a-Box
    is installed and should not need to be changed.

    [DB]_PASSWORD
    : the password for the "web" user to access the mysql database.
    This is set to the database web password you specify when you
    initially install SWAMP-in-a-Box.

Miscellaneous settings
----------------------
The following parameters are set when you install SWAMP-in-the-Box.
These settings control various operations of the Laravel framework and
should not be changed.

    CACHE_DRIVER=file
    QUEUE_DRIVER=sync
